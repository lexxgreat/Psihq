<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>–ú–∏—Ä–∞ ‚Äî –ò–ò-–ø—Å–∏—Ö–æ–ª–æ–≥</title>
<link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,600;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet" />
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: 'Lora', Georgia, serif; background: #f5f0eb; color: #2c2c2c; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: #c9b99a; border-radius: 3px; }

  /* NAV */
  nav { background: #fff; border-bottom: 1px solid #e2d9ce; padding: 0 24px; height: 60px; display: flex; align-items: center; justify-content: space-between; flex-shrink: 0; box-shadow: 0 1px 8px rgba(0,0,0,0.06); z-index: 100; }
  .nav-logo { display: flex; align-items: center; gap: 10px; cursor: pointer; text-decoration: none; }
  .nav-logo-icon { width: 32px; height: 32px; background: #8b6347; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 16px; }
  .nav-logo-text { font-family: 'Lora', serif; font-size: 18px; font-weight: 600; color: #3d2b1f; }
  .nav-actions { display: flex; gap: 10px; align-items: center; }
  .btn { cursor: pointer; font-family: 'DM Sans', sans-serif; border: none; transition: all 0.2s; }
  .btn-voice { background: none; border: 1px solid #d4c4b0 !important; border-radius: 8px; padding: 6px 14px; font-size: 13px; color: #6b4f3a; display: flex; align-items: center; gap: 6px; }
  .btn-voice.active { background: #fff3ec !important; border-color: #e8a87c !important; color: #c9693a !important; }
  .btn-sessions { background: none; border: 1px solid #d4c4b0; border-radius: 8px; padding: 6px 14px; font-size: 13px; color: #6b4f3a; display: flex; align-items: center; gap: 6px; }
  .badge { background: #8b6347; color: #fff; border-radius: 10px; padding: 1px 6px; font-size: 11px; }
  .btn-donate { background: #c9956a; color: #fff; border-radius: 8px; padding: 7px 16px; font-size: 13px; font-weight: 500; }
  .btn-donate:hover { background: #b07a52; }

  /* PAGES */
  .page { display: none; flex: 1; overflow: hidden; }
  .page.active { display: flex; flex-direction: column; }

  /* HOME */
  #home-page { overflow-y: auto; }
  .home-inner { max-width: 800px; margin: 0 auto; padding: 60px 24px; }
  .hero { text-align: center; margin-bottom: 60px; }
  .hero-icon { font-size: 56px; margin-bottom: 20px; }
  .hero h1 { font-family: 'Lora', serif; font-size: clamp(32px,5vw,52px); font-weight: 600; color: #3d2b1f; line-height: 1.2; margin-bottom: 16px; }
  .hero h1 em { font-style: italic; color: #8b6347; }
  .hero p { font-family: 'DM Sans', sans-serif; font-size: 17px; color: #7a6558; max-width: 500px; margin: 0 auto 32px; line-height: 1.7; }
  .btn-start { background: #8b6347; color: #fff; border: none; border-radius: 12px; padding: 14px 32px; font-size: 16px; font-weight: 500; cursor: pointer; box-shadow: 0 4px 16px rgba(139,99,71,0.3); transition: all 0.2s; }
  .btn-start:hover { background: #6b4f3a; }
  .features { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px,1fr)); gap: 20px; margin-bottom: 60px; }
  .feature-card { background: #fff; border-radius: 16px; padding: 24px; border: 1px solid #e8ddd2; text-align: center; }
  .feature-card .icon { font-size: 32px; margin-bottom: 10px; }
  .feature-card h3 { font-family: 'Lora', serif; font-weight: 600; font-size: 16px; color: #3d2b1f; margin-bottom: 6px; }
  .feature-card p { font-family: 'DM Sans', sans-serif; font-size: 14px; color: #9a8578; line-height: 1.5; }
  .starters h2 { font-family: 'Lora', serif; font-size: 20px; color: #3d2b1f; margin-bottom: 16px; text-align: center; }
  .starter-btn { width: 100%; background: #fff; border: 1px solid #e2d5c6; border-radius: 12px; padding: 14px 20px; text-align: left; font-family: 'DM Sans', sans-serif; font-size: 15px; color: #5c4233; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
  .starter-btn:hover { background: #e8ddd0; transform: translateY(-1px); }
  .starter-btn .arr { color: #c9956a; }
  .disclaimer { font-family: 'DM Sans', sans-serif; font-size: 12px; color: #b0a090; text-align: center; margin-top: 48px; line-height: 1.6; }

  /* CHAT LAYOUT */
  #chat-page { flex-direction: row; }
  .sidebar { width: 280px; background: #fff; border-right: 1px solid #e2d9ce; display: flex; flex-direction: column; flex-shrink: 0; }
  .sidebar.hidden { display: none; }
  .sidebar-header { padding: 16px 16px 12px; border-bottom: 1px solid #ede5d8; display: flex; justify-content: space-between; align-items: center; }
  .sidebar-title { font-family: 'Lora', serif; font-size: 15px; font-weight: 600; color: #3d2b1f; }
  .btn-new { background: #8b6347; color: #fff; border: none; border-radius: 8px; padding: 5px 12px; font-size: 12px; cursor: pointer; font-family: 'DM Sans', sans-serif; }
  .sessions-list { flex: 1; overflow-y: auto; padding: 8px; }
  .session-item { padding: 10px 12px; border-radius: 10px; cursor: pointer; margin-bottom: 4px; transition: background 0.15s; display: flex; justify-content: space-between; align-items: flex-start; }
  .session-item:hover, .session-item.active { background: #ede5d8; }
  .session-info { flex: 1; min-width: 0; }
  .session-name { font-family: 'DM Sans', sans-serif; font-size: 13px; color: #3d2b1f; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .session-meta { font-family: 'DM Sans', sans-serif; font-size: 11px; color: #b0a090; margin-top: 2px; }
  .btn-del { background: none; border: none; color: #c9a090; font-size: 14px; padding: 0 0 0 8px; cursor: pointer; opacity: 0.6; }
  .btn-del:hover { opacity: 1; }

  /* CHAT MAIN */
  .chat-main { flex: 1; display: flex; flex-direction: column; min-width: 0; }
  .chat-header { padding: 12px 20px; border-bottom: 1px solid #e2d9ce; background: #fff; display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; }
  .chat-title { font-family: 'Lora', serif; font-size: 15px; font-weight: 600; color: #3d2b1f; }
  .chat-date { font-family: 'DM Sans', sans-serif; font-size: 12px; color: #9a8578; }
  .status-row { display: flex; align-items: center; gap: 12px; }
  .online-dot { width: 8px; height: 8px; background: #7cb87c; border-radius: 50%; display: inline-block; }
  .online-text { font-family: 'DM Sans', sans-serif; font-size: 12px; color: #7cb87c; }
  .speaking-badge { display: flex; align-items: center; gap: 8px; background: #fff8f4; border: 1px solid #e8c4a0; border-radius: 20px; padding: 4px 14px; }
  .speaking-text { font-family: 'DM Sans', sans-serif; font-size: 12px; color: #8b6347; }

  /* MESSAGES */
  .messages { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 16px; }
  .welcome { text-align: center; margin-top: 40px; }
  .welcome-icon { font-size: 40px; margin-bottom: 12px; }
  .welcome h2 { font-family: 'Lora', serif; font-size: 18px; color: #8b6347; margin-bottom: 8px; }
  .welcome p { font-family: 'DM Sans', sans-serif; color: #9a8578; font-size: 14px; }
  .welcome .voice-hint { color: #c9956a; margin-top: 10px; font-size: 13px; }
  .msg-wrap { display: flex; align-items: flex-end; gap: 10px; }
  .msg-wrap.user { justify-content: flex-end; }
  .msg-avatar { width: 32px; height: 32px; background: #8b6347; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; }
  .msg-bubble { max-width: 70%; }
  .msg-text { padding: 12px 16px; font-family: 'DM Sans', sans-serif; font-size: 15px; line-height: 1.6; box-shadow: 0 2px 8px rgba(0,0,0,0.06); white-space: pre-wrap; }
  .msg-wrap.user .msg-text { background: #8b6347; color: #fff; border-radius: 18px 18px 4px 18px; }
  .msg-wrap.ai .msg-text { background: #fff; color: #3d2b1f; border-radius: 18px 18px 18px 4px; border: 1px solid #e8ddd2; }
  .msg-time { font-family: 'DM Sans', sans-serif; font-size: 11px; color: #c0b0a0; margin-top: 4px; padding: 0 4px; }
  .msg-wrap.user .msg-time { text-align: right; }

  /* TYPING */
  .typing-wrap { display: flex; align-items: flex-end; gap: 10px; }
  .typing-bubble { background: #fff; border: 1px solid #e8ddd2; border-radius: 18px 18px 18px 4px; padding: 14px 18px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
  .dot { display: inline-block; width: 7px; height: 7px; background: #c9a078; border-radius: 50%; margin: 0 2px; animation: typing 1.4s infinite; }
  .dot:nth-child(2) { animation-delay: 0.2s; }
  .dot:nth-child(3) { animation-delay: 0.4s; }
  @keyframes typing { 0%,60%,100% { transform:translateY(0); opacity:.4; } 30% { transform:translateY(-6px); opacity:1; } }

  /* LISTENING BANNER */
  .listening-banner { padding: 10px 20px; background: #fff8f4; border-top: 1px solid #f0d8c4; display: flex; align-items: center; gap: 12px; flex-shrink: 0; }
  .listening-banner.hidden { display: none; }
  .rec-dot { width: 10px; height: 10px; background: #e05c3a; border-radius: 50%; flex-shrink: 0; box-shadow: 0 0 0 3px rgba(224,92,58,0.2); animation: rec-pulse 1.2s ease-out infinite; }
  @keyframes rec-pulse { 0% { box-shadow: 0 0 0 0 rgba(224,92,58,0.4); } 70% { box-shadow: 0 0 0 10px rgba(224,92,58,0); } 100% { box-shadow: 0 0 0 0 rgba(224,92,58,0); } }
  .listening-text { font-family: 'DM Sans', sans-serif; font-size: 14px; color: #8b6347; font-style: italic; flex: 1; }
  .listening-hint { font-family: 'DM Sans', sans-serif; font-size: 12px; color: #b0a090; }

  /* INPUT */
  .input-area { padding: 16px 20px; background: #fff; border-top: 1px solid #e2d9ce; flex-shrink: 0; }
  .input-box { display: flex; gap: 8px; background: #f8f3ee; border-radius: 16px; border: 1px solid #e2d5c6; padding: 8px 8px 8px 16px; align-items: flex-end; transition: border-color 0.2s; }
  .input-box.recording { border-color: #e8a878; }
  #msg-input { flex: 1; background: transparent; border: none; outline: none; font-family: 'DM Sans', sans-serif; font-size: 15px; color: #3d2b1f; line-height: 1.5; max-height: 120px; overflow-y: auto; padding-top: 6px; resize: none; }
  .btn-mic { background: #c9b09a; color: #fff; border: none; border-radius: 12px; width: 40px; height: 40px; font-size: 18px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: background 0.2s; flex-shrink: 0; }
  .btn-mic.recording { background: #e05c3a; animation: mic-pulse 1.2s ease-out infinite; }
  @keyframes mic-pulse { 0% { box-shadow:0 0 0 0 rgba(224,92,58,0.5); } 70% { box-shadow:0 0 0 12px rgba(224,92,58,0); } 100% { box-shadow:0 0 0 0 rgba(224,92,58,0); } }
  .btn-send { background: #d4c4b0; color: #fff; border: none; border-radius: 12px; width: 40px; height: 40px; font-size: 20px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: background 0.2s; flex-shrink: 0; line-height: 1; }
  .btn-send.ready { background: #8b6347; }
  .btn-send.ready:hover { background: #6b4f3a; }
  .input-footer { display: flex; justify-content: space-between; margin-top: 8px; }
  .input-hint { font-family: 'DM Sans', sans-serif; font-size: 11px; color: #c0b0a0; }
  .voice-active-hint { font-family: 'DM Sans', sans-serif; font-size: 11px; color: #c9956a; }

  /* EMPTY CHAT */
  .empty-chat { flex: 1; display: flex; align-items: center; justify-content: center; flex-direction: column; gap: 16px; }
  .empty-chat p { font-family: 'DM Sans', sans-serif; color: #9a8578; font-size: 15px; }

  /* WAVE ANIMATION */
  .wave { display: flex; align-items: center; height: 20px; gap: 2px; }
  .wave-bar { display: inline-block; width: 3px; border-radius: 2px; background: #8b6347; }
  .wave-bar:nth-child(1) { height: 8px;  animation: wave 0.7s ease-in-out infinite; }
  .wave-bar:nth-child(2) { height: 14px; animation: wave 0.7s ease-in-out infinite 0.1s; }
  .wave-bar:nth-child(3) { height: 18px; animation: wave 0.7s ease-in-out infinite 0.2s; }
  .wave-bar:nth-child(4) { height: 14px; animation: wave 0.7s ease-in-out infinite 0.1s; }
  .wave-bar:nth-child(5) { height: 8px;  animation: wave 0.7s ease-in-out infinite; }
  @keyframes wave { 0%,100% { transform:scaleY(0.4); } 50% { transform:scaleY(1); } }

  /* MODAL */
  .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(45,30,20,0.5); z-index: 200; align-items: center; justify-content: center; padding: 20px; }
  .modal-overlay.show { display: flex; animation: fadeOverlay 0.2s ease; }
  @keyframes fadeOverlay { from { opacity:0; } to { opacity:1; } }
  .modal { background: #fff; border-radius: 20px; padding: 36px; max-width: 420px; width: 100%; box-shadow: 0 20px 60px rgba(0,0,0,0.2); }
  .modal-icon { font-size: 44px; text-align: center; margin-bottom: 12px; }
  .modal h2 { font-family: 'Lora', serif; font-size: 24px; color: #3d2b1f; margin-bottom: 8px; text-align: center; }
  .modal p { font-family: 'DM Sans', sans-serif; font-size: 14px; color: #9a8578; line-height: 1.6; text-align: center; margin-bottom: 24px; }
  .donate-amounts { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 16px; }
  .donate-amount { background: #f5ede4; color: #6b4f3a; border: 1px solid #ddd0c4; border-radius: 12px; padding: 12px; font-size: 16px; font-weight: 500; cursor: pointer; font-family: 'DM Sans', sans-serif; transition: all 0.2s; }
  .donate-amount:hover { background: #8b6347; color: #fff; }
  .donate-custom { display: flex; gap: 8px; align-items: center; border: 1px solid #e2d5c6; border-radius: 10px; padding: 8px 14px; background: #faf7f4; margin-bottom: 20px; }
  .donate-custom input { flex: 1; border: none; font-size: 14px; color: #3d2b1f; background: transparent; outline: none; font-family: 'DM Sans', sans-serif; }
  .donate-custom span { font-family: 'DM Sans', sans-serif; font-size: 14px; color: #9a8578; }
  .btn-pay { width: 100%; background: #8b6347; color: #fff; border: none; border-radius: 12px; padding: 13px; font-size: 15px; font-weight: 500; cursor: pointer; font-family: 'DM Sans', sans-serif; margin-bottom: 10px; transition: background 0.2s; }
  .btn-pay:hover { background: #6b4f3a; }
  .btn-close-modal { width: 100%; background: none; border: none; color: #b0a090; font-size: 14px; padding: 6px; cursor: pointer; font-family: 'DM Sans', sans-serif; }

  /* ANIMATIONS */
  @keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }
  @keyframes slideRight { from { opacity:0; transform:translateX(20px); } to { opacity:1; transform:translateX(0); } }
  @keyframes slideLeft { from { opacity:0; transform:translateX(-20px); } to { opacity:1; transform:translateX(0); } }
  .fade-in { animation: fadeIn 0.5s ease forwards; }
  .slide-right { animation: slideRight 0.3s ease; }
  .slide-left { animation: slideLeft 0.3s ease; }
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <a class="nav-logo" onclick="showPage('home')">
    <div class="nav-logo-icon">üåø</div>
    <span class="nav-logo-text">–ú–∏—Ä–∞</span>
  </a>
  <div class="nav-actions">
    <button id="btn-voice-toggle" class="btn btn-voice" onclick="toggleVoice()" style="display:none">üéôÔ∏è –ì–æ–ª–æ—Å</button>
    <button id="btn-sessions-toggle" class="btn btn-sessions" onclick="toggleSidebar()" style="display:none">
      üìã –°–µ—Å—Å–∏–∏ <span id="sessions-badge" class="badge" style="display:none">0</span>
    </button>
    <button class="btn btn-donate" onclick="showDonate()">‚òï –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å</button>
  </div>
</nav>

<!-- HOME PAGE -->
<div id="home-page" class="page active">
  <div class="home-inner fade-in">
    <div class="hero">
      <div class="hero-icon">üåø</div>
      <h1>–ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è<br /><em>–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –¥–∏–∞–ª–æ–≥–∞</em></h1>
      <p>–ú–∏—Ä–∞ ‚Äî –ò–ò-–ø—Å–∏—Ö–æ–ª–æ–≥, –∫–æ—Ç–æ—Ä—ã–π –≤—ã—Å–ª—É—à–∞–µ—Ç –±–µ–∑ –æ—Å—É–∂–¥–µ–Ω–∏—è, –∑–∞–¥–∞—Å—Ç –æ–¥–∏–Ω —Ç–æ—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å –∏ –ø–æ–º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ —Ç–æ—á–∫—É –æ–ø–æ—Ä—ã.</p>
      <button class="btn-start" onclick="createSession()">–ù–∞—á–∞—Ç—å —Å–µ—Å—Å–∏—é ‚Üí</button>
    </div>
    <div class="features">
      <div class="feature-card">
        <div class="icon">üîí</div>
        <h3>–ë–µ–∑–æ–ø–∞—Å–Ω–æ</h3>
        <p>–í—Å—ë –æ—Å—Ç–∞—ë—Ç—Å—è –º–µ–∂–¥—É –≤–∞–º–∏ –∏ –ú–∏—Ä–æ–π</p>
      </div>
      <div class="feature-card">
        <div class="icon">üéôÔ∏è</div>
        <h3>–ì–æ–ª–æ—Å–æ–≤–æ–π —Ä–µ–∂–∏–º</h3>
        <p>–ì–æ–≤–æ—Ä–∏—Ç–µ –∏ —Å–ª—É—à–∞–π—Ç–µ ‚Äî –∫–∞–∫ —Å –∂–∏–≤—ã–º –ø—Å–∏—Ö–æ–ª–æ–≥–æ–º</p>
      </div>
      <div class="feature-card">
        <div class="icon">üå±</div>
        <h3>–û–¥–∏–Ω –≤–æ–ø—Ä–æ—Å</h3>
        <p>–ú–∏—Ä–∞ –Ω–µ –ø—É—Ç–∞–µ—Ç ‚Äî –≤—Å–µ–≥–¥–∞ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ –æ–¥–Ω–æ–º—É</p>
      </div>
    </div>
    <div class="starters">
      <h2>–° —á–µ–≥–æ –Ω–∞—á–∞—Ç—å?</h2>
      <button class="starter-btn" onclick="createSession('–Ø —á—É–≤—Å—Ç–≤—É—é —Ç—Ä–µ–≤–æ–≥—É –∏ –Ω–µ –ø–æ–Ω–∏–º–∞—é –ø–æ—á–µ–º—É')"><span class="arr">‚Üí</span> –Ø —á—É–≤—Å—Ç–≤—É—é —Ç—Ä–µ–≤–æ–≥—É –∏ –Ω–µ –ø–æ–Ω–∏–º–∞—é –ø–æ—á–µ–º—É</button>
      <button class="starter-btn" onclick="createSession('–£ –º–µ–Ω—è –ø—Ä–æ–±–ª–µ–º—ã –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö')"><span class="arr">‚Üí</span> –£ –º–µ–Ω—è –ø—Ä–æ–±–ª–µ–º—ã –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö</button>
      <button class="starter-btn" onclick="createSession('–Ø –æ—á–µ–Ω—å —É—Å—Ç–∞–ª –∏ –Ω–µ –≤–∏–∂—É —Å–º—ã—Å–ª–∞')"><span class="arr">‚Üí</span> –Ø –æ—á–µ–Ω—å —É—Å—Ç–∞–ª –∏ –Ω–µ –≤–∏–∂—É —Å–º—ã—Å–ª–∞</button>
      <button class="starter-btn" onclick="createSession('–ú–Ω–µ —Ç—Ä—É–¥–Ω–æ —Å–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å–æ —Å—Ç—Ä–µ—Å—Å–æ–º')"><span class="arr">‚Üí</span> –ú–Ω–µ —Ç—Ä—É–¥–Ω–æ —Å–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å–æ —Å—Ç—Ä–µ—Å—Å–æ–º</button>
    </div>
    <p class="disclaimer">–ú–∏—Ä–∞ ‚Äî –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –∏ –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫—É—é –ø–æ–º–æ—â—å.<br />–ü—Ä–∏ —Å–µ—Ä—å—ë–∑–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É.</p>
  </div>
</div>

<!-- CHAT PAGE -->
<div id="chat-page" class="page">
  <!-- Sidebar -->
  <div id="sidebar" class="sidebar hidden">
    <div class="sidebar-header">
      <span class="sidebar-title">–°–µ—Å—Å–∏–∏</span>
      <button class="btn-new" onclick="createSession()">+ –ù–æ–≤–∞—è</button>
    </div>
    <div class="sessions-list" id="sessions-list"></div>
  </div>

  <!-- Chat Main -->
  <div class="chat-main">
    <!-- Empty state -->
    <div class="empty-chat" id="empty-chat">
      <span style="font-size:40px">üåø</span>
      <p>–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Å—Å–∏—é –∏–ª–∏ –Ω–∞—á–Ω–∏—Ç–µ –Ω–æ–≤—É—é</p>
      <button class="btn-start" style="font-size:14px;padding:10px 24px" onclick="createSession()">–ù–æ–≤–∞—è —Å–µ—Å—Å–∏—è</button>
    </div>

    <!-- Active chat -->
    <div id="active-chat" style="display:none;flex-direction:column;flex:1;min-height:0;display:none">
      <!-- Header -->
      <div class="chat-header">
        <div>
          <div class="chat-title" id="chat-title">–°–µ—Å—Å–∏—è</div>
          <div class="chat-date" id="chat-date"></div>
        </div>
        <div class="status-row">
          <div id="speaking-badge" class="speaking-badge" style="display:none">
            <div class="wave"><span class="wave-bar"></span><span class="wave-bar"></span><span class="wave-bar"></span><span class="wave-bar"></span><span class="wave-bar"></span></div>
            <span class="speaking-text">–ú–∏—Ä–∞ –≥–æ–≤–æ—Ä–∏—Ç...</span>
          </div>
          <span class="online-dot"></span>
          <span class="online-text">–æ–Ω–ª–∞–π–Ω</span>
        </div>
      </div>

      <!-- Messages -->
      <div class="messages" id="messages"></div>

      <!-- Listening banner -->
      <div class="listening-banner hidden" id="listening-banner">
        <div class="rec-dot"></div>
        <span class="listening-text" id="listening-text">–°–ª—É—à–∞—é...</span>
        <span class="listening-hint">–ù–∞–∂–º–∏—Ç–µ ‚èπ —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å</span>
      </div>

      <!-- Input -->
      <div class="input-area">
        <div class="input-box" id="input-box">
          <textarea id="msg-input" rows="1" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å..."
            oninput="onInputChange()" onkeydown="onKeyDown(event)"></textarea>
          <button class="btn-mic" id="btn-mic" onclick="handleMicClick()" style="display:none" title="–ó–∞–ø–∏—Å—å –≥–æ–ª–æ—Å–∞">üéôÔ∏è</button>
          <button class="btn-send" id="btn-send" onclick="sendMessage()">‚Üë</button>
        </div>
        <div class="input-footer">
          <span class="input-hint">Enter ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å ¬∑ Shift+Enter ‚Äî –ø–µ—Ä–µ–Ω–æ—Å</span>
          <span class="voice-active-hint" id="voice-hint" style="display:none">üéôÔ∏è –ì–æ–ª–æ—Å –∞–∫—Ç–∏–≤–µ–Ω</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- DONATE MODAL -->
<div class="modal-overlay" id="donate-modal" onclick="hideDonate(event)">
  <div class="modal">
    <div class="modal-icon">‚òï</div>
    <h2>–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ú–∏—Ä—É</h2>
    <p>–í–∞—à–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–º–æ–≥–∞–µ—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å –∏ –¥–µ–ª–∞—Ç—å –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫—É—é –ø–æ–º–æ—â—å –¥–æ—Å—Ç—É–ø–Ω–æ–π –¥–ª—è –≤—Å–µ—Ö.</p>
    <div class="donate-amounts">
      <button class="donate-amount">100 ‚ÇΩ</button>
      <button class="donate-amount">250 ‚ÇΩ</button>
      <button class="donate-amount">500 ‚ÇΩ</button>
      <button class="donate-amount">1000 ‚ÇΩ</button>
    </div>
    <div class="donate-custom">
      <input type="number" placeholder="–î—Ä—É–≥–∞—è —Å—É–º–º–∞..." />
      <span>‚ÇΩ</span>
    </div>
    <button class="btn-pay">–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ ‚Üí</button>
    <button class="btn-close-modal" onclick="hideDonate()">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
</div>

<script>
// ‚úÖ API-–ö–õ–Æ–ß MISTRAL (console.mistral.ai ‚Üí API Keys)
const API_KEY = 'M5nbRuR54o1Mnz5hfpaSHi4xa2FYFbsI';

const SYSTEM_PROMPT = `–¢—ã ‚Äî –ú–∏—Ä–∞, —Ç—ë–ø–ª—ã–π –∏ —ç–º–ø–∞—Ç–∏—á–Ω—ã–π –ò–ò-–ø—Å–∏—Ö–æ–ª–æ–≥. –¢—ã –æ–±—â–∞–µ—à—å—Å—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.

–¢–≤–æ–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã:
- –ì–æ–≤–æ—Ä–∏ –º—è–≥–∫–æ, —Å –∑–∞–±–æ—Ç–æ–π –∏ –±–µ–∑ –æ—Å—É–∂–¥–µ–Ω–∏—è
- –í–ê–ñ–ù–û: –∑–∞–¥–∞–≤–∞–π –¢–û–õ–¨–ö–û –û–î–ò–ù –≤–æ–ø—Ä–æ—Å –∑–∞ —Ä–∞–∑ ‚Äî –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∑–∞–¥–∞–≤–∞–π –¥–≤–∞ –∏ –±–æ–ª–µ–µ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥. –û–¥–∏–Ω –≤–æ–ø—Ä–æ—Å ‚Äî –æ–¥–∏–Ω –æ—Ç–≤–µ—Ç. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç —á–µ–ª–æ–≤–µ–∫—É —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è.
- –ò—Å–ø–æ–ª—å–∑—É–π —Ç–µ—Ö–Ω–∏–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–ª—É—à–∞–Ω–∏—è: –æ—Ç—Ä–∞–∂–∞–π —á—É–≤—Å—Ç–≤–∞, –ø–µ—Ä–µ—Ñ—Ä–∞–∑–∏—Ä—É–π —É—Å–ª—ã—à–∞–Ω–Ω–æ–µ
- –ù–µ —Å—Ç–∞–≤—å –¥–∏–∞–≥–Ω–æ–∑—ã, –Ω–µ –¥–∞–≤–∞–π –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —Å–æ–≤–µ—Ç–æ–≤
- –ü–æ–º–æ–≥–∞–π –Ω–∞–π—Ç–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –∏ —Ä–µ—à–µ–Ω–∏—è —á–µ—Ä–µ–∑ –¥–∏–∞–ª–æ–≥
- –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –º–∞–∫—Å–∏–º—É–º), –∑–∞—Ç–µ–º ‚Äî –æ–¥–∏–Ω –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –º—è–≥–∫–æ–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å
- –ò–Ω–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π –ø—Ä–æ—Å—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏: –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, –∑–∞–∑–µ–º–ª–µ–Ω–∏–µ, –ø–µ—Ä–µ–æ—Å–º—ã—Å–ª–µ–Ω–∏–µ —Å–∏—Ç—É–∞—Ü–∏–∏
- –ü—Ä–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö —Å–µ—Ä—å—ë–∑–Ω–æ–≥–æ –∫—Ä–∏–∑–∏—Å–∞ –º—è–≥–∫–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–π –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –∂–∏–≤–æ–º—É —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É

–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞: —Å–Ω–∞—á–∞–ª–∞ –æ—Ç–∫–ª–∏–∫ –Ω–∞ —Å–∫–∞–∑–∞–Ω–Ω–æ–µ (—ç–º–ø–∞—Ç–∏—è/—Ä–µ—Ñ–ª–µ–∫—Å–∏—è), –∑–∞—Ç–µ–º –º–∞–∫—Å–∏–º—É–º –æ–¥–∏–Ω –≤–æ–ø—Ä–æ—Å. –ù–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–π —á–µ–ª–æ–≤–µ–∫–∞.`;

// State
let sessions = JSON.parse(localStorage.getItem('mira_sessions') || '[]');
let activeId = null;
let voiceEnabled = false;
let isListening = false;
let isSpeaking = false;
let voiceTranscript = '';
let recognition = null;
let loading = false;
let sidebarOpen = false;

function saveSession() {
  localStorage.setItem('mira_sessions', JSON.stringify(sessions));
}

function getSession(id) { return sessions.find(s => s.id === id); }

function formatTime(ts) {
  return new Date(ts).toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
}
function formatDate(ts) {
  return new Date(ts).toLocaleDateString('ru-RU', { day: 'numeric', month: 'long' });
}

// PAGE NAVIGATION
function showPage(name) {
  document.getElementById('home-page').classList.toggle('active', name === 'home');
  document.getElementById('chat-page').classList.toggle('active', name === 'chat');
  document.getElementById('btn-voice-toggle').style.display = name === 'chat' ? '' : 'none';
  document.getElementById('btn-sessions-toggle').style.display = name === 'chat' ? '' : 'none';
  if (name === 'home') { window.speechSynthesis && speechSynthesis.cancel(); }
}

// SESSIONS UI
function renderSessions() {
  const list = document.getElementById('sessions-list');
  const badge = document.getElementById('sessions-badge');
  badge.textContent = sessions.length;
  badge.style.display = sessions.length > 0 ? '' : 'none';

  if (sessions.length === 0) {
    list.innerHTML = '<p style="font-family:\'DM Sans\',sans-serif;font-size:13px;color:#b0a090;text-align:center;margin-top:24px">–ù–µ—Ç —Å–µ—Å—Å–∏–π</p>';
    return;
  }
  list.innerHTML = sessions.map(s => `
    <div class="session-item ${s.id === activeId ? 'active' : ''}" onclick="openSession('${s.id}')">
      <div class="session-info">
        <div class="session-name">${escHtml(s.title)}</div>
        <div class="session-meta">${formatDate(s.createdAt)} ¬∑ ${s.messages.length} —Å–æ–æ–±—â.</div>
      </div>
      <button class="btn-del" onclick="deleteSession(event,'${s.id}')">‚úï</button>
    </div>
  `).join('');
}

function openSession(id) {
  activeId = id;
  renderSessions();
  renderChat();
}

function deleteSession(e, id) {
  e.stopPropagation();
  sessions = sessions.filter(s => s.id !== id);
  saveSession();
  if (activeId === id) { activeId = null; renderChat(); }
  renderSessions();
}

function toggleSidebar() {
  sidebarOpen = !sidebarOpen;
  document.getElementById('sidebar').classList.toggle('hidden', !sidebarOpen);
}

// CREATE SESSION
function createSession(starterText = null) {
  const id = Date.now().toString();
  const sess = {
    id,
    title: starterText ? starterText.slice(0, 30) + (starterText.length > 30 ? '...' : '') : '–ù–æ–≤–∞—è —Å–µ—Å—Å–∏—è',
    createdAt: Date.now(),
    messages: []
  };
  sessions.unshift(sess);
  saveSession();
  activeId = id;
  showPage('chat');
  renderSessions();
  renderChat();
  if (starterText) setTimeout(() => doSend(starterText), 100);
}

// RENDER CHAT
function renderChat() {
  const emptyEl = document.getElementById('empty-chat');
  const activeEl = document.getElementById('active-chat');
  const sess = getSession(activeId);

  if (!sess) {
    emptyEl.style.display = 'flex';
    activeEl.style.display = 'none';
    return;
  }

  emptyEl.style.display = 'none';
  activeEl.style.display = 'flex';
  activeEl.style.flexDirection = 'column';
  activeEl.style.flex = '1';
  activeEl.style.minHeight = '0';

  document.getElementById('chat-title').textContent = sess.title;
  document.getElementById('chat-date').textContent = formatDate(sess.createdAt);

  const msgEl = document.getElementById('messages');
  if (sess.messages.length === 0) {
    msgEl.innerHTML = `
      <div class="welcome fade-in">
        <div class="welcome-icon">üåø</div>
        <h2>–ü—Ä–∏–≤–µ—Ç, —è –ú–∏—Ä–∞</h2>
        <p>–†–∞—Å—Å–∫–∞–∂–∏, —á—Ç–æ —Ç–µ–±—è –ø—Ä–∏–≤–µ–ª–æ —Å—é–¥–∞ —Å–µ–≥–æ–¥–Ω—è?</p>
        ${voiceEnabled ? '<p class="voice-hint">üéôÔ∏è –ì–æ–ª–æ—Å–æ–≤–æ–π —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–µ–Ω ‚Äî –Ω–∞–∂–º–∏—Ç–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω –∏ –≥–æ–≤–æ—Ä–∏—Ç–µ</p>' : ''}
      </div>`;
  } else {
    msgEl.innerHTML = sess.messages.map(m => renderMsg(m)).join('');
  }
  scrollToBottom();
}

function renderMsg(m) {
  const isUser = m.role === 'user';
  return `
    <div class="msg-wrap ${isUser ? 'user slide-right' : 'ai slide-left'}">
      ${!isUser ? '<div class="msg-avatar">üåø</div>' : ''}
      <div class="msg-bubble">
        <div class="msg-text">${escHtml(m.content)}</div>
        <div class="msg-time">${formatTime(m.ts)}</div>
      </div>
    </div>`;
}

function appendMsg(m) {
  const msgEl = document.getElementById('messages');
  // Remove welcome if present
  const welcome = msgEl.querySelector('.welcome');
  if (welcome) welcome.remove();
  const div = document.createElement('div');
  div.innerHTML = renderMsg(m);
  msgEl.appendChild(div.firstElementChild);
  scrollToBottom();
}

function showTyping() {
  const msgEl = document.getElementById('messages');
  const div = document.createElement('div');
  div.id = 'typing-indicator';
  div.className = 'typing-wrap';
  div.innerHTML = `<div class="msg-avatar">üåø</div><div class="typing-bubble"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>`;
  msgEl.appendChild(div);
  scrollToBottom();
}

function hideTyping() {
  document.getElementById('typing-indicator')?.remove();
}

function scrollToBottom() {
  const el = document.getElementById('messages');
  setTimeout(() => { el.scrollTop = el.scrollHeight; }, 50);
}

// SEND MESSAGE
function sendMessage() {
  const input = document.getElementById('msg-input');
  const text = isListening ? voiceTranscript : input.value.trim();
  if (!text || loading) return;
  if (isListening) stopListening();
  doSend(text);
}

async function doSend(text, sessId = activeId) {
  if (!text.trim() || loading) return;
  const input = document.getElementById('msg-input');
  input.value = '';
  input.style.height = 'auto';
  voiceTranscript = '';
  updateListeningBanner();
  updateSendBtn();

  const sess = getSession(sessId);
  if (!sess) return;

  const userMsg = { role: 'user', content: text.trim(), ts: Date.now() };
  sess.messages.push(userMsg);
  if (sess.messages.length === 1) {
    sess.title = text.slice(0, 35) + (text.length > 35 ? '...' : '');
    document.getElementById('chat-title').textContent = sess.title;
    renderSessions();
  }
  saveSession();
  appendMsg(userMsg);

  loading = true;
  showTyping();

  try {
    const res = await fetch('https://api.mistral.ai/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${API_KEY}`
      },
      body: JSON.stringify({
        model: 'mistral-small-latest',
        max_tokens: 1000,
        messages: [
          { role: 'system', content: SYSTEM_PROMPT },
          ...sess.messages.map(m => ({ role: m.role, content: m.content }))
        ]
      })
    });
    const data = await res.json();
    const reply = data.choices?.[0]?.message?.content || '–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –ø–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑.';
    hideTyping();
    const aiMsg = { role: 'assistant', content: reply, ts: Date.now() };
    sess.messages.push(aiMsg);
    saveSession();
    appendMsg(aiMsg);
    if (voiceEnabled) speakText(reply);
  } catch {
    hideTyping();
    const errMsg = { role: 'assistant', content: '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –ü—Ä–æ–≤–µ—Ä—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∏ –ø–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞.', ts: Date.now() };
    sess.messages.push(errMsg);
    saveSession();
    appendMsg(errMsg);
  }
  loading = false;
}

function onInputChange() {
  const input = document.getElementById('msg-input');
  input.style.height = 'auto';
  input.style.height = Math.min(input.scrollHeight, 120) + 'px';
  updateSendBtn();
}

function onKeyDown(e) {
  if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMessage(); }
}

function updateSendBtn() {
  const input = document.getElementById('msg-input');
  const hasText = (isListening ? voiceTranscript : input.value).trim();
  const btn = document.getElementById('btn-send');
  btn.classList.toggle('ready', !!hasText && !loading);
}

// VOICE
function toggleVoice() {
  voiceEnabled = !voiceEnabled;
  const btn = document.getElementById('btn-voice-toggle');
  btn.textContent = voiceEnabled ? 'üéôÔ∏è –ì–æ–ª–æ—Å –≤–∫–ª' : 'üéôÔ∏è –ì–æ–ª–æ—Å';
  btn.classList.toggle('active', voiceEnabled);
  document.getElementById('btn-mic').style.display = voiceEnabled ? '' : 'none';
  document.getElementById('voice-hint').style.display = voiceEnabled ? '' : 'none';
  if (!voiceEnabled) { speechSynthesis.cancel(); stopListening(); setIsSpeaking(false); }
  // Update placeholder
  document.getElementById('msg-input').placeholder = voiceEnabled
    ? '–ù–∞–ø–∏—à–∏—Ç–µ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ üéôÔ∏è...' : '–ù–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å...';
  // Refresh welcome hint
  renderChat();
}

function handleMicClick() {
  if (isListening) {
    stopListening();
    setTimeout(() => { if (voiceTranscript.trim()) doSend(voiceTranscript); }, 300);
  } else {
    startListening();
  }
}

function startListening() {
  const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
  if (!SR) { alert('–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º Chrome –∏–ª–∏ Edge.'); return; }
  speechSynthesis.cancel();
  setIsSpeaking(false);

  const rec = new SR();
  rec.lang = 'ru-RU';
  rec.continuous = false;
  rec.interimResults = true;
  rec.onstart = () => { isListening = true; voiceTranscript = ''; updateListeningBanner(); updateMicBtn(); };
  rec.onresult = (e) => {
    voiceTranscript = Array.from(e.results).map(r => r[0].transcript).join('');
    document.getElementById('listening-text').textContent = voiceTranscript || '–°–ª—É—à–∞—é...';
    updateSendBtn();
  };
  rec.onend = () => { isListening = false; recognition = null; updateListeningBanner(); updateMicBtn(); };
  rec.onerror = (e) => { isListening = false; recognition = null; updateListeningBanner(); updateMicBtn(); };
  recognition = rec;
  rec.start();
}

function stopListening() {
  recognition?.stop();
  isListening = false;
  recognition = null;
  updateListeningBanner();
  updateMicBtn();
}

function updateListeningBanner() {
  const banner = document.getElementById('listening-banner');
  banner.classList.toggle('hidden', !isListening);
  document.getElementById('input-box').classList.toggle('recording', isListening);
  document.getElementById('msg-input').placeholder = isListening ? '–ì–æ–≤–æ—Ä–∏—Ç–µ...' : (voiceEnabled ? '–ù–∞–ø–∏—à–∏—Ç–µ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ üéôÔ∏è...' : '–ù–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å...');
}

function updateMicBtn() {
  const btn = document.getElementById('btn-mic');
  btn.classList.toggle('recording', isListening);
  btn.textContent = isListening ? '‚èπ' : 'üéôÔ∏è';
  btn.title = isListening ? '–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å' : '–ó–∞–ø–∏—Å—å –≥–æ–ª–æ—Å–∞';
}

function speakText(text) {
  if (!window.speechSynthesis) return;
  speechSynthesis.cancel();
  const utter = new SpeechSynthesisUtterance(text);
  utter.lang = 'ru-RU';
  utter.rate = 0.92;
  utter.pitch = 1.05;
  const voices = speechSynthesis.getVoices();
  const v = voices.find(v => v.lang.startsWith('ru') && v.name.toLowerCase().includes('female'))
    || voices.find(v => v.lang.startsWith('ru'))
    || voices.find(v => v.name.toLowerCase().includes('female'));
  if (v) utter.voice = v;
  utter.onstart = () => setIsSpeaking(true);
  utter.onend = () => setIsSpeaking(false);
  utter.onerror = () => setIsSpeaking(false);
  speechSynthesis.speak(utter);
}

function setIsSpeaking(val) {
  isSpeaking = val;
  document.getElementById('speaking-badge').style.display = val ? 'flex' : 'none';
}

// DONATE
function showDonate() { document.getElementById('donate-modal').classList.add('show'); }
function hideDonate(e) {
  if (!e || e.target === document.getElementById('donate-modal')) {
    document.getElementById('donate-modal').classList.remove('show');
  }
}

function escHtml(str) {
  return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;');
}

// Load voices async
if (window.speechSynthesis) {
  speechSynthesis.getVoices();
  speechSynthesis.addEventListener('voiceschanged', () => {});
}

// Init
renderSessions();
</script>
</body>
</html>
